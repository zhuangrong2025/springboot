<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>

</head>
<body style="background-color:#252525">
closure
</body>
<script>
    var a = 5;


    // 闭包-通用写法
    (function(){
        function foo(){
            var a = 2;
            function bar(){
                console.log(a)
            }
            return bar
        }
        var baz = foo()
        baz()
    })();

    // 闭包，被外部函数调用
    (function(){
        function foo(){
            var a = 2;
            function bar(){
                console.log(a)
            }
            baz(bar)
        }
        function baz(fn){
            fn()
        }
        foo()
    })()

    // 赋值给全局变量
    var fn;
    (function(){
        function foo(){
            var a = 2;
            function bar(){
                console.log(a)
            }
            fn = bar
        }
        function baz(){
            fn()
        }

        foo()  // 先赋值
        baz()

    })()


  //setTimeout
  function wait(message) {

  	setTimeout( function timer(){
  		console.log( message );
  	}, 1000 );

  }

  wait( "Hello, closure!" );

  //闭包模块化，api接口
  (function(){
      var foo = (function(id){

        function change(){
            publicApi.identify = identify2
        }

        function identify1(){
            console.log(id)
        }
        function identify2(){
            console.log(id.toUpperCase())
        }

        var publicApi ={ // return
            change: change,
            identify: identify1
        }
        return publicApi

      })("foo module")

    foo.identify()
    foo.change()
    foo.identify()
  })()





</script>
</html>
